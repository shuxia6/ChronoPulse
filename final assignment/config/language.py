# 多语言字典
LANG = {
    "zh": {
        "welcome": "=== 心理健康小助手 ===",
        "menu": "请选择功能: 1=记录心情, 2=查看当天趋势, 3=每周报告, 4=数据管理, 5=查看心情日历, 6=查看总趋势, 7=导出日报, 8=切换语言/Change language, 0=退出: ",
        "choose_mood": "请输入现在的心情 (1=开心, 2=一般, 3=压力大, 或直接输入心情): ",
        "invalid": "输入无效，请输入 1, 2, 3 或有效的心情名称",
        "not_number": "请输入数字！",
        "saved": "已保存",
        "no_data": "还没有心情记录，先来添加一条吧！",
        "avg": "平均心情指数：{:.2f} (范围 1=差, 3=好)",
        "suggest_happy": "小建议：继续保持这种好状态！🌞",
        "suggest_ok": "小建议：找点让你开心的小事做吧！🌱",
        "suggest_stress": "小建议：注意休息，出去走走或运动一下。😊",
        "choose_lang": "请选择语言 / Choose language (1=中文/Chinese, 2=英文/English): ",
        "plot_title": "心情趋势图",
        "plot_xlabel": "时间",
        "plot_ylabel": "心情指数 (1=差, 3=好)",
        "lang_changed": "语言已切换为中文 / Language changed to Chinese",
        "data_management": "数据管理选项:",
        "view_records": "1. 查看最近10条记录",
        "delete_record": "2. 删除最新记录",
        "export_data": "3. 导出数据 (CSV/JSON)",
        "search_notes": "4. 按关键词搜索备注",
        "choose_option": "请选择: ",
        "record_deleted": "已删除: {}",
        "no_data_to_delete": "没有数据可删除",
        "weekly_report": "=== 每周心情报告 ===",
        "record_count": "记录数量: {}",
        "avg_mood_score": "平均心情分数: {:.2f}",
        "daily_avg_mood": "每日平均心情:",
        "week_summary_good": "👍 本周整体心情不错，继续保持!",
        "week_summary_normal": "😐 本周心情一般，可以尝试做些让自己开心的事",
        "week_summary_bad": "👎 本周心情较差，建议多休息或寻求帮助",
        "no_records_week": "最近7天没有心情记录",
        "exit_message": "感谢使用心理健康小助手！",
        "invalid_input": "⚠️ 无效输入，请重新选择",
        "export_data_success": "数据已导出到",
        "choose_export_format": "选择导出格式 / Choose export format: 1=CSV, 2=JSON",
        "pie_chart_saved": "饼图已保存为",
        "calendar_saved": "日历已保存为",
        "enter_year_month": "请输入年月 (YYYY-MM): ",
        "enter_date": "请输入日期 (YYYY-MM-DD): ",
        "report_saved": "报告已导出到",
        "score_label": "分数",
        "enter_note": "请输入备注（可选，按回车跳过）",
        "note_label": "备注",
        "no_note": "无备注",
        "best_mood": "最佳心情时刻: {} (分数: {})",
        "worst_mood": "最差心情时刻: {} (分数: {})",
        "trend_line": "趋势线",
        "plot_best": "最佳",
        "plot_worst": "最差",
        "plot_saved": "图表已保存为 {}",
        "enter_keyword": "请输入搜索关键词: ",
        "no_keyword_found": "没有找到包含 '{}' 的备注。",
        "found_records_for": "找到 {} 条包含 '{}' 的记录:"
    },
    "en": {
        "welcome": "=== Mental Health Assistant ===",
        "menu": "Choose function: 1=Record mood, 2=View today trend, 3=Weekly report, 4=Data management, 5=View Mood Calendar, 6=View Overall Trend, 7=Export Daily Report, 8=Change language/切换语言, 0=Exit: ",
        "choose_mood": "Enter your current mood (1=Happy, 2=Neutral, 3=Stressed, or type the mood): ",
        "invalid": "Invalid input, please enter 1, 2, 3, or a valid mood name.",
        "not_number": "Please enter a number!",
        "saved": "Saved",
        "no_data": "No mood records yet, please add one first!",
        "avg": "Average mood score: {:.2f} (Range: 1=Bad, 3=Good)",
        "suggest_happy": "Tip: Great job, keep this positive energy! 🌞",
        "suggest_ok": "Tip: Find something fun to brighten your day! 🌱",
        "suggest_stress": "Tip: Take a break, go for a walk or exercise. 😊",
        "choose_lang": "Choose language / 请选择语言 (1=Chinese/中文, 2=English/英文): ",
        "plot_title": "Mood Trend",
        "plot_xlabel": "Time",
        "plot_ylabel": "Mood Score (1=Bad, 3=Good)",
        "lang_changed": "Language changed to English / 语言已切换为英文",
        "data_management": "Data management options:",
        "view_records": "1. View last 10 records",
        "delete_record": "2. Delete latest record",
        "export_data": "3. Export data (CSV/JSON)",
        "search_notes": "4. Search notes by keyword",
        "choose_option": "Please choose: ",
        "record_deleted": "Deleted: {}",
        "no_data_to_delete": "No data to delete",
        "weekly_report": "=== Weekly Mood Report ===",
        "record_count": "Record count: {}",
        "avg_mood_score": "Average mood score: {:.2f}",
        "daily_avg_mood": "Daily average mood:",
        "week_summary_good": "👍 Good mood this week, keep it up!",
        "week_summary_normal": "😐 Average mood this week, try to do something fun",
        "week_summary_bad": "👎 Low mood this week, consider resting or seeking help",
        "no_records_week": "No mood records in the last 7 days",
        "exit_message": "Thank you for using Mental Health Assistant!",
        "invalid_input": "⚠️ Invalid input, please try again",
        "export_data_success": "Data exported to",
        "choose_export_format": "Choose export format / 选择导出格式: 1=CSV, 2=JSON",
        "pie_chart_saved": "Pie chart saved as",
        "calendar_saved": "Calendar saved as",
        "enter_year_month": "Enter year-month (YYYY-MM): ",
        "enter_date": "Enter date (YYYY-MM-DD): ",
        "report_saved": "Report exported to",
        "score_label": "Score",
        "enter_note": "Enter note (optional, press Enter to skip): ",
        "note_label": "Note",
        "no_note": "No note",
        "best_mood": "Best mood moment: {} (Score: {})",
        "worst_mood": "Worst mood moment: {} (Score: {})",
        "trend_line": "Trend Line",
        "plot_best": "Best",
        "plot_worst": "Worst",
        "plot_saved": "Chart saved as {}",
        "enter_keyword": "Enter keyword to search: ",
        "no_keyword_found": "No records found containing '{}'.",
        "found_records_for": "Found {} record(s) containing '{}':"
    }
}


def get_language():
    """读取或设置语言"""
    from config.settings import CONFIG_FILE
    import os
    if os.path.exists(CONFIG_FILE):
        with open(CONFIG_FILE, "r", encoding="utf-8") as f:
            lang = f.read().strip()
            if lang in LANG:
                return lang
    return "zh"  # 默认中文


def change_language():
    """切换语言并保存到配置文件"""
    from config.settings import CONFIG_FILE
    while True:
        choice = input(LANG[get_language()]["choose_lang"]).strip()
        if choice == "1":
            lang = "zh"
            break
        elif choice == "2":
            lang = "en"
            break
        else:
            current_lang = get_language()
            print("输入无效，请输入 1 或 2 / Invalid input, please enter 1 or 2.")
    with open(CONFIG_FILE, "w", encoding="utf-8") as f:
        f.write(lang)
    print(LANG[lang]["lang_changed"])
    return lang